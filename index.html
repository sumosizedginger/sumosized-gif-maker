<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SumoSized GIF Maker | The Elite Browser Studio</title>
    <meta name="description"
        content="The world's most elite browser-based GIF studio. Create high-quality GIFs from videos or images with pro filters and zero server uploads.">

    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="SumoSized GIF Maker">
    <meta property="og:description" content="Elite Browser GIF Studio - No Uploads, All Pro.">
    <meta property="og:image" content="https://sumosizedginger.github.io/sumosized-gif-maker/preview.png">
    <meta name="twitter:card" content="summary_large_image">

    <!-- Pre-load & Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@600;700;800&display=swap"
        rel="stylesheet">

    <!-- CSS & Favicon -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">
    <link rel="manifest" href="manifest.json">

    <!-- Essential Scripts -->
    <script>
        // Register the COI service worker to enable SharedArrayBuffer for FFmpeg.wasm
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./coi-serviceworker.js').then(() => {
                if (!navigator.serviceWorker.controller) {
                    window.location.reload();
                }
            });
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gifshot/0.3.2/gifshot.min.js" defer></script>
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.0/color-thief.umd.js" defer></script>
    <script src="https://unpkg.com/lucide@latest" defer></script>
    <script src="js/main.js" defer></script>
</head>

<body>
    <div class="container" role="main">
        <header>
            <h1>SumoSized</h1>
            <div class="subtitle">Elite Browser GIF Studio</div>
        </header>

        <div class="mode-switcher" role="tablist">
            <button class="mode-btn active" role="tab" aria-selected="true" onclick="switchMode('video')">
                <i data-lucide="video"></i> Video Studio
            </button>
            <button class="mode-btn" role="tab" aria-selected="false" onclick="switchMode('images')">
                <i data-lucide="image"></i> Image Slideshow
            </button>
        </div>

        <div class="main-card">
            <!-- Video Upload Section -->
            <div id="videoUploadSection" class="upload-section">
                <div style="margin-bottom: 30px;">
                    <i data-lucide="clapperboard"
                        style="width: 64px; height: 64px; color: var(--action-green); opacity: 0.8;"></i>
                </div>
                <label for="videoUpload" class="upload-btn">
                    Select Elite Video
                </label>
                <input type="file" id="videoUpload" accept="video/mp4,video/x-m4v,video/*">
                <p style="margin-top: 25px; color: var(--text-secondary); font-size: 0.9rem;">
                    MP4, MOV, or WEBM up to 50MB
                </p>
            </div>

            <!-- Image Upload Section -->
            <div id="imageUploadSection" class="upload-section" style="display: none;">
                <div style="margin-bottom: 30px;">
                    <i data-lucide="images"
                        style="width: 64px; height: 64px; color: var(--action-green); opacity: 0.8;"></i>
                </div>
                <label for="imageUpload" class="upload-btn">
                    Select Elite Images
                </label>
                <input type="file" id="imageUpload" accept="image/*" multiple>
                <p style="margin-top: 20px; color: var(--text-secondary); font-size: 0.9rem;">
                    Upload multiple images to stitch into a custom GIF
                </p>

                <div id="slideshowGrid" class="slideshow-grid"></div>
            </div>

            <div class="video-section active" id="videoSection">
                <div class="video-container" id="videoContainer">
                    <div id="loadingPlaceholder"
                        style="position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(0,34,68,0.4); border-radius: 12px; z-index: 5;">
                        <i data-lucide="monitor-play"
                            style="width: 48px; height: 48px; color: var(--action-green); margin-bottom: 15px; opacity: 0.5;"></i>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">Awaiting Elite Media...</p>
                    </div>
                    <video id="videoPlayer" style="display: none;"></video>
                    <img id="imagePlaceholder"
                        style="display: none; width: 100%; max-height: 500px; border-radius: 12px; border: 1px solid rgba(77, 255, 0, 0.15);">
                    <div class="cropper-overlay" id="cropperOverlay">
                        <div class="cropper-box" id="cropperBox"></div>
                    </div>
                </div>
                <div class="video-info" id="videoInfo"></div>
            </div>

            <div class="controls-panel" id="controlsPanel">
                <div class="time-controls" id="trimControls">
                    <div class="time-display">
                        <span>Start: <span id="startTimeDisplay">0.0s</span></span>
                        <span>Duration: <span id="durationDisplay">2.0s</span></span>
                        <span>End: <span id="endTimeDisplay">2.0s</span></span>
                    </div>

                    <div class="range-container">
                        <div class="range-slider"></div>
                        <div class="range-selected" id="rangeSelected"></div>
                        <input type="range" id="startRange" min="0" max="100" value="0" step="0.1"
                            aria-label="Start time">
                        <input type="range" id="endRange" min="0" max="100" value="20" step="0.1" aria-label="End time">
                    </div>

                    <p class="trim-hint">Drag handles to select clip region &mdash; <strong id="sliderMaxLabel">max
                            10s</strong> recommended</p>
                </div>

                <div class="feature-tabs" role="tablist">
                    <button class="tab-btn active" role="tab" aria-selected="true" onclick="switchTab('settings')">
                        <i data-lucide="settings"></i> Settings
                    </button>
                    <button class="tab-btn" role="tab" aria-selected="false" onclick="switchTab('filters')">
                        <i data-lucide="sparkles"></i> Filters
                    </button>
                    <button class="tab-btn" role="tab" aria-selected="false" onclick="switchTab('overlays')">
                        <i data-lucide="type"></i> Overlays
                    </button>
                </div>

                <!-- Settings Panel -->
                <div id="settingsPanel" class="advanced-panel active" role="tabpanel">
                    <div class="settings-grid">
                        <div class="setting-group">
                            <label class="setting-label">Width (px)</label>
                            <input type="number" id="gifWidth" class="setting-input" value="480" min="100" max="1024"
                                step="10">
                        </div>

                        <div class="setting-group">
                            <label class="setting-label">Frame Rate (FPS)</label>
                            <input type="number" id="fps" class="setting-input" value="15" min="1" max="60" step="1">
                        </div>

                        <div class="setting-group" id="speedGroup">
                            <label class="setting-label">Speed</label>
                            <select id="speed" class="setting-input" onchange="updatePredictor()">
                                <option value="0.5">0.5x (Slow)</option>
                                <option value="1" selected>1.0x (Normal)</option>
                                <option value="1.5">1.5x (Fast)</option>
                                <option value="2">2.0x (Turbo)</option>
                            </select>
                        </div>

                        <div class="setting-group" id="loopGroup">
                            <label class="setting-label">Loop Mode</label>
                            <select id="loopMode" class="setting-input" onchange="updatePredictor()">
                                <option value="normal" selected>Normal</option>
                                <option value="reverse">Reverse</option>
                                <option value="boomerang">Boomerang</option>
                            </select>
                        </div>

                        <div class="setting-group" id="delayGroup" style="display: none;">
                            <label class="setting-label">Frame Delay (ms)</label>
                            <input type="number" id="frameDelay" class="setting-input" value="200" min="50" step="50">
                        </div>

                        <div class="setting-group">
                            <label class="setting-label">Pro Crop</label>
                            <select id="cropRatio" class="setting-input" onchange="toggleCropper(this.value)">
                                <option value="off" selected>Off (Full)</option>
                                <option value="original">Free Crop</option>
                                <option value="9:16">TikTok (9:16)</option>
                                <option value="1:1">Instagram (1:1)</option>
                                <option value="4:5">FB/Portalt (4:5)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Filters Panel -->
                <div id="filtersPanel" class="advanced-panel" role="tabpanel">
                    <div class="filter-grid" id="filterGrid">
                        <div class="filter-card active" onclick="setFilter('none', this)">
                            <span class="filter-label">None</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('grayscale', this)">
                            <span class="filter-label">Noir</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('sepia', this)">
                            <span class="filter-label">Retro</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('vibrant', this)">
                            <span class="filter-label">Vibrant Pop</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('8bit', this)">
                            <span class="filter-label">8-Bit Retro</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('dreamy', this)">
                            <span class="filter-label">Dreamy Wash</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('golden', this)">
                            <span class="filter-label">Golden Hour</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('gladiator', this)">
                            <span class="filter-label">Gladiator</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('nightvision', this)">
                            <span class="filter-label">Night Vision</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('sulphur', this)">
                            <span class="filter-label">Sulphur</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('coldblue', this)">
                            <span class="filter-label">Cold Blue</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('vignette', this)">
                            <span class="filter-label">Vignette</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('mirror', this)">
                            <span class="filter-label">Mirror Flip</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('grain', this)">
                            <span class="filter-label">Film Grain</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('invert', this)">
                            <span class="filter-label">Invert</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('vhs', this)">
                            <span class="filter-label">üìº VHS Retro</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('psychedelic', this)">
                            <span class="filter-label">üåà Psychedelia</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('thermal', this)">
                            <span class="filter-label">üî• Thermal</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('glitch', this)">
                            <span class="filter-label">üëæ Glitch</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('cyberpunk', this)">
                            <span class="filter-label">üß¨ Cyberpunk</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('chrome', this)">
                            <span class="filter-label">üíø Chrome</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('blueprint', this)">
                            <span class="filter-label">üìê Blueprint</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('matrix', this)">
                            <span class="filter-label">üìü Matrix</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('oldmovie', this)">
                            <span class="filter-label">üéûÔ∏è Old Movie</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('mirrormode', this)">
                            <span class="filter-label">ü™û Kaleidoscope</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('comic', this)">
                            <span class="filter-label">üí• Comic Book</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('acid', this)">
                            <span class="filter-label">üåÄ Acid Trip</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('sketch', this)">
                            <span class="filter-label">‚úèÔ∏è Sketch</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('infrared', this)">
                            <span class="filter-label">üõ∞Ô∏è Infrared</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('seahawks', this)">
                            <span class="filter-label">ü¶Ö Seahawks</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('technicolor', this)">
                            <span class="filter-label">üìΩÔ∏è Technicolor</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('golden2', this)">
                            <span class="filter-label">üèÜ Golden II</span>
                        </div>
                        <div class="filter-card" onclick="setFilter('posterize', this)">
                            <span class="filter-label">üé® Posterize</span>
                        </div>
                    </div>
                </div>

                <!-- Overlays Panel -->
                <div id="overlaysPanel" class="advanced-panel" role="tabpanel">
                    <div class="setting-group">
                        <label class="setting-label">Overlay Text</label>
                        <input type="text" id="overlayText" class="setting-input" placeholder="Enter caption..."
                            oninput="updatePredictor()">
                    </div>
                    <div class="settings-grid" style="margin-top: 15px;">
                        <div class="setting-group">
                            <label class="setting-label">Size</label>
                            <input type="number" id="textSize" class="setting-input" value="32" min="10" max="100">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Position</label>
                            <select id="textPos" class="setting-input">
                                <option value="top">Top</option>
                                <option value="middle">Middle</option>
                                <option value="bottom" selected>Bottom</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Word Spacing</label>
                            <input type="number" id="wordSpacing" class="setting-input" value="1" min="0" max="50">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Font Family</label>
                            <select id="fontStyle" class="setting-input">
                                <option value="Arimo-Regular.ttf">Standard (Arimo)</option>
                                <option value="LiberationSans-Regular.ttf">Liberation Sans</option>
                                <option value="Roboto-Regular.ttf">Roboto (Modern)</option>
                                <option value="Anton-Regular.ttf">Anton (Headline)</option>
                                <option value="Orbitron.ttf">Orbitron (Sci-Fi)</option>
                                <option value="PermanentMarker-Regular.ttf">Marker (Street)</option>
                                <option value="Montserrat-Regular.ttf">Montserrat</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Line Spacing</label>
                            <input type="number" id="lineSpacing" class="setting-input" value="20" min="0" max="100">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Text Box</label>
                            <select id="textBox" class="setting-input">
                                <option value="0" selected>None</option>
                                <option value="1">Background Slug</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Text Color</label>
                            <select id="textColor" class="setting-input">
                                <option value="#4DFF00" selected>Action Green</option>
                                <option value="cyan">Cyan</option>
                                <option value="yellow">Yellow</option>
                                <option value="red">Red</option>
                                <option value="black">Black</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Box Padding</label>
                            <input type="number" id="boxPadding" class="setting-input" value="10" min="0" max="50">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Box Opacity</label>
                            <input type="number" id="boxOpacity" class="setting-input" value="0.5" min="0" max="1"
                                step="0.1">
                        </div>
                    </div>
                </div>

                <div class="size-predictor">
                    <span>Quality Index: <span class="size-val" id="qualityEst">Ultra High</span></span>
                    <span>| Processor: <span class="size-val">Elite (FFmpeg)</span></span>
                </div>
            </div>

            <div class="action-section" id="actionSection" style="display: none;">
                <button class="btn btn-primary" id="convertBtn" onclick="startConversion()">
                    ‚ö° Convert to GIF
                </button>
                <button class="btn btn-secondary" onclick="resetVideo()">
                    üóëÔ∏è New Video
                </button>

                <div class="progress-container" id="progressContainer">
                    <div class="progress-info">
                        <span id="progressStatus">Extracting frames...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
            </div>

            <div class="preview-section" id="previewSection">
                <h3 style="margin-bottom: 20px; color: var(--action-green);">‚ú® Your GIF is Ready!</h3>
                <img id="resultGif" class="preview-image" src="" alt="Generated GIF">
                <div>
                    <a id="downloadBtn" class="btn btn-primary" download="converted.gif">
                        ‚¨áÔ∏è Download GIF
                    </a>
                    <button class="btn btn-secondary" onclick="closePreview()">
                        üîÑ Convert Another Section
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>
</body>

</html>